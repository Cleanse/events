<div class="basic-page">
    <div class="container">
        <div class="page-title">
            <h1>Edit Event</h1>
            <div class="sub-box"></div>
            <p class="mt-1 small text-primary">{{ event.name }}</p>
        </div>
    </div>

    <div class="container basic-content">
        <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <a class="nav-item nav-link active" id="nav-matches-tab" data-toggle="tab" href="#nav-matches"
                   role="tab" aria-controls="nav-home" aria-selected="true">Matches</a>
                <a class="nav-item nav-link" id="nav-teams-tab" data-toggle="tab" href="#nav-teams"
                   role="tab" aria-controls="nav-teams" aria-selected="false">Teams</a>
                <a class="nav-item nav-link" id="nav-settings-tab" data-toggle="tab" href="#nav-settings"
                   role="tab" aria-controls="nav-settings" aria-selected="false">Settings</a>
            </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-matches" role="tabpanel" aria-labelledby="nav-matches-tab">
                {% partial '@_no-matches.htm' %}
            </div>
            <div class="tab-pane fade" id="nav-teams" role="tabpanel" aria-labelledby="nav-teams-tab">
                {% partial '@_add-team.htm' %}
            </div>
            <div class="tab-pane fade" id="nav-settings" role="tabpanel" aria-labelledby="nav-settings-tab">
                <form data-request="onEventUpdate"
                      data-request-validate>

                    <div class="alert alert-danger d-none" role="alert" data-validate-error>
                        <p class="mb-0" data-message></p>
                    </div>

                    <div class="form-group">
                        <label for="event-title">Event Title</label>
                        <input id="event-title" name="event-title" type="text" class="form-control"
                               value="{{ event.name }}" placeholder="Event Title">
                    </div>

                    <div class="form-group">
                        <label for="event-description">Event Description</label>
                        <textarea id="event-description" name="event-description"
                                  class="form-control">{{ event.description }}</textarea>
                    </div>

                    <hr>

                    <div class="form-group">
                        <label for="event-type">Event Type</label>
                        <select id="event-type" name="event-type" class="form-control">
                            <option value="">Select One</option>
                            {% for type in event_types %}
                            <option value="{{ type.value }}" {% if event.type == type.value %}selected{% endif %}>
                                {{ type.display }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div id="event-config"></div>

                    <button type="submit" class="btn btn-info">
                        Next
                    </button>

                </form>
            </div>
        </div>
    </div>
</div>

<script>
    let setDefaults = function() {
        let settings = {{ event.config|raw }};

        for (const [key, value] of Object.entries(settings)) {
            let formElementExists = document.getElementById(`event_config[${key}]`);
            formElementExists.value = value;
        }
    };

    window.onload = setTimeout(setDefaults, 3000);
</script>